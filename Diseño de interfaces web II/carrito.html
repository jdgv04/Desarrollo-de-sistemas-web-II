<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tienda Sara - Carrito</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .producto-img {
      width: 90px;
      height: 90px;
      object-fit: cover;
      border-radius: 8px;
    }
  </style>
</head>

<body>

<!-- NAVBAR PRINCIPAL -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <a class="navbar-brand" href="index.html">
      <img src="imagenes/images.png" width="40" height="40" class="me-2">
      Tienda Sara
    </a>

    <input class="form-control w-50" type="search" placeholder="Buscar productos">

    <a href="carrito.html" class="btn btn-warning">
      <img src="imagenes/carrito.png" width="40" height="40">
    </a>
  </div>
</nav>

<!-- NAVBAR SECUNDARIA -->
<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
  <div class="container">
    <ul class="navbar-nav mx-auto">
      <li class="nav-item"><a class="nav-link fw-bold" href="galeria.html">Categorías</a></li>
      <li class="nav-item"><a class="nav-link" href="#">Guantes</a></li>
      <li class="nav-item"><a class="nav-link" href="#">Bates</a></li>
      <li class="nav-item"><a class="nav-link" href="#">Ropa</a></li>
      <li class="nav-item"><a class="nav-link" href="#">Ofertas</a></li>
    </ul>
  </div>
</nav>

<div class="container mt-5">

  <h2 class="mb-4">Carrito de Compra</h2>

  <div id="listaCarrito"></div>

  <div class="card mt-4">
    <div class="card-body">
      <h4>Total: $<span id="total">0</span></h4>
      <button class="btn btn-success mt-3">Proceder al pago</button>
      <a href="index.html" class="btn btn-outline-secondary mt-3">Seguir comprando</a>
      <button class="btn btn-danger mt-3" onclick="vaciarCarrito()">Vaciar carrito</button>
    </div>
  </div>

</div>

<script>

let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

function mostrarCarrito() {

  let lista = document.getElementById("listaCarrito");
  let total = 0;
  lista.innerHTML = "";

  if (carrito.length === 0) {
    lista.innerHTML = "<p>Tu carrito está vacío.</p>";
    document.getElementById("total").innerText = 0;
    return;
  }

  carrito.forEach((producto, index) => {

    let subtotal = producto.precio * producto.cantidad;
    total += subtotal;

    lista.innerHTML += `
      <div class="card mb-3">
        <div class="card-body d-flex align-items-center justify-content-between">

          <div class="d-flex align-items-center">
            <img src="${producto.imagen}" class="producto-img me-3">
            <div>
              <h5>${producto.nombre}</h5>
              <p class="mb-1">Precio: $${producto.precio}</p>
              <input type="number" min="1" value="${producto.cantidad}"
                class="form-control w-50"
                onchange="cambiarCantidad(${index}, this.value)">
            </div>
          </div>

          <div class="text-end">
            <p class="fw-bold">Subtotal: $${subtotal}</p>
            <button class="btn btn-danger btn-sm"
              onclick="eliminarProducto(${index})">
              Eliminar
            </button>
          </div>

        </div>
      </div>
    `;
  });

  document.getElementById("total").innerText = total;
}

function cambiarCantidad(index, nuevaCantidad) {
  carrito[index].cantidad = parseInt(nuevaCantidad);
  localStorage.setItem("carrito", JSON.stringify(carrito));
  mostrarCarrito();
}

function eliminarProducto(index) {
  carrito.splice(index, 1);
  localStorage.setItem("carrito", JSON.stringify(carrito));
  mostrarCarrito();
}

function vaciarCarrito() {
  localStorage.removeItem("carrito");
  carrito = [];
  mostrarCarrito();
}

mostrarCarrito();

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>